function [ t_final, pos_vals, nose_vals,dists, th_vals,dirs_vals,success,success_idx,pathlength,sx,sy,conc_vals] = concTrackFun_smooth_comp_ou_active_nav_variant( side_l, conc_thres, capture_dist , varargin)  % vel    vel_min     noiselevel     maxt

%%% Jim Hengenius, August 29, 2016
%%% Mouse odor tracking simulation using comparison of times since last
%%% odor encounter. Consists primarily of Tim Whalen's original tracker
%%% with the addition of scalable arena size, , and variable
%%% velocity.

%% Options for model variants and behaviors

% Set to one for correlated random walk (noise in theta)
randwalk = 1;

% Set to one for random spot location
randspot = 1;

% Set to one for odor thresholding, otherwise disregard provided threshold
thresholding = 1;
if ~thresholding
    conc_thres = 0;
end

% Bounded arena? (Reflective walls if 1)
bounded = 1;


% Use real arena dimensions (yes if 1)
arena = 1;
side_lx = 114.3/2;
side_ly = 91.400/2;

% Set spot location (default 0,0)
if randspot
%     spots = [-53.2967857142857,-37.7971428571429;-52.8950000000000,-38.4221428571429;-52.8950000000000,37.2921428571429;-52.8057142857143,21.6671428571429;-52.6271428571429,-39.2257142857143;-52.5378571428572,22.4707142857143;-52.3592857142857,-36.3685714285714;-52.3592857142857,-8.60071428571428;-52.2700000000000,-38.4221428571429;-52.2700000000000,25.4171428571429;-52.1807142857143,-14.3150000000000;-51.8682142857143,-35.7435714285714;-51.7342857142857,32.4707142857143;-51.5557142857143,-35.8328571428571;-51.4664285714286,-35.4757142857143;-51.2878571428572,-36.0114285714286;-51.1985714285714,-35.8328571428571;-51.1092857142857,-36.1900000000000;-51.1092857142857,-33.4221428571429;-51.0200000000000,-32.8864285714286;-50.9307142857143,-37.0828571428571;-50.9307142857143,-33.2435714285714;-50.4842857142857,-35.9221428571429;-50.1271428571429,-34.9400000000000;-50.1271428571429,-34.4042857142857;-50.0378571428572,0.0600000000000023;-49.8592857142857,40.2385714285714;-49.5914285714286,-36.5471428571429;-49.4128571428572,2.02428571428572;-49.3235714285714,-36.4578571428571;-49.2342857142857,21.4885714285714;-49.0557142857143,-36.1900000000000;-49.0557142857143,31.9350000000000;-48.5200000000000,-37.7971428571429;-48.3414285714286,-28.3328571428571;-48.2521428571429,5.14928571428572;-48.0735714285714,30.5957142857143;-47.8057142857143,8.09571428571429;-47.7164285714286,-27.9757142857143;-47.2700000000000,39.4350000000000;-47.1807142857143,38.2742857142857;-47.0914285714286,-1.72571428571428;-47.0021428571429,-33.1542857142857;-47.0021428571429,38.4528571428572;-46.9128571428572,39.7028571428572;-46.7342857142857,-1.19000000000000;-46.7342857142857,25.0600000000000;-46.1985714285714,23.8992857142857;-46.1985714285714,37.7385714285714;-45.9307142857143,26.2207142857143;-45.8414285714286,0.417142857142864;-45.3950000000000,-32.1721428571429;-45.1271428571429,0.238571428571433;-45.1271428571429,40.7742857142857;-44.8592857142857,39.7028571428572;-44.7700000000000,34.2564285714286;-44.6807142857143,3.81000000000000;-44.5914285714286,-9.35964285714285;-44.5914285714286,3.18500000000000;-44.4128571428572,34.7028571428572;-44.3235714285714,-37.7971428571429;-44.2342857142857,37.1135714285714;-44.1450000000000,0.238571428571433;-43.9664285714286,31.9350000000000;-43.8771428571429,-27.6632142857143;-43.8771428571429,35.8635714285714;-43.6985714285714,6.31000000000000;-43.6092857142857,3.45285714285715;-42.8950000000000,1.04214285714286;-42.7164285714286,-36.4578571428571;-42.7164285714286,-11.3685714285714;-42.4485714285714,-1.27928571428571;-42.4485714285714,4.97071428571429;-42.3592857142857,-36.0114285714286;-42.0914285714286,-6.01142857142857;-42.0914285714286,1.08678571428572;-41.7342857142857,-2.26142857142857;-41.4664285714286,38.2742857142857;-41.3771428571429,-25.5650000000000;-41.2878571428572,3.00642857142858;-41.1985714285714,28.4528571428572;-41.0200000000000,2.64928571428572;-40.8414285714286,40.7742857142857;-40.4842857142857,-12.8864285714286;-40.1271428571429,-9.67214285714285;-40.0378571428572,6.13142857142858;-39.8592857142857,-3.33285714285714;-39.8146428571429,-16.9935714285714;-39.7700000000000,-4.85071428571428;-39.6807142857143,-9.58285714285714;-39.5914285714286,-11.6364285714286;-39.5914285714286,-4.49357142857142;-39.5021428571429,-25.2078571428571;-39.1450000000000,-24.4042857142857;-39.1450000000000,3.98857142857143;-39.1450000000000,19.3457142857143;-39.0557142857143,-13.7792857142857;-39.0557142857143,26.6671428571429;-38.9664285714286,35.9528571428572;-38.8771428571429,30.5957142857143;-38.8771428571429,39.4350000000000;-38.7878571428572,-20.2078571428571;-38.7878571428572,-17.9757142857143;-38.7878571428572,-17.9757142857143;-38.4307142857143,40.5957142857143;-38.3414285714286,22.6046428571429;-38.1628571428572,-12.2614285714286;-38.0735714285714,-12.2614285714286;-38.0735714285714,23.4528571428572;-37.9842857142857,-7.79714285714285;-37.9842857142857,6.13142857142858;-37.8057142857143,-5.47571428571428;-37.5378571428572,13.8100000000000;-37.4485714285714,-23.8685714285714;-37.0914285714286,-11.9042857142857;-37.0914285714286,-10.1185714285714;-37.0914285714286,1.75642857142858;-37.0914285714286,6.13142857142858;-36.9128571428572,-27.4400000000000;-36.9128571428572,-18.5114285714286;-36.9128571428572,-3.51142857142857;-36.7342857142857,-0.743571428571421;-36.5557142857143,4.16714285714286;-36.4664285714286,-8.24357142857142;-36.3771428571429,-7.35071428571428;-36.3771428571429,31.9350000000000;-36.1985714285714,19.4350000000000;-36.1092857142857,-15.3864285714286;-36.1092857142857,-14.5828571428571;-36.1092857142857,6.66714285714286;-36.0200000000000,22.6492857142857;-35.9307142857143,-18.7792857142857;-35.7521428571429,1.75642857142858;-35.6628571428572,-13.5114285714286;-35.5735714285714,6.57785714285715;-35.4842857142857,-20.5650000000000;-35.4842857142857,37.1135714285714;-35.3950000000000,1.62250000000000;-35.3950000000000,32.6492857142857;-35.3057142857143,-12.2614285714286;-35.2164285714286,-23.4221428571429;-35.1271428571429,-18.6007142857143;-35.1271428571429,-2.79714285714285;-35.0378571428572,2.47071428571429;-34.8592857142857,1.04214285714286;-34.7700000000000,-19.3150000000000;-34.6807142857143,7.73857142857143;-34.5914285714286,-10.5650000000000;-34.5914285714286,-0.922142857142852;-34.5021428571429,14.9707142857143;-34.3235714285714,-34.1364285714286;-34.3235714285714,5.41714285714286;-34.2342857142857,-16.5471428571429;-34.2342857142857,39.7921428571429;-34.1450000000000,-37.7971428571429;-34.1450000000000,-29.4935714285714;-34.0557142857143,5.68500000000000;-33.9664285714286,-35.9221428571429;-33.9664285714286,-4.94000000000000;-33.8771428571429,22.6492857142857;-33.6092857142857,-17.6185714285714;-33.6092857142857,13.0064285714286;-33.6092857142857,17.3814285714286;-33.5200000000000,-15.9221428571429;-33.3414285714286,12.0242857142857;-33.3414285714286,25.5957142857143;-33.1628571428572,-24.4935714285714;-33.1628571428572,5.23857142857143;-32.9842857142857,-17.3507142857143;-32.8057142857143,8.89928571428572;-32.6271428571429,-21.4578571428571;-32.5378571428572,-25.0292857142857;-32.5378571428572,-13.9578571428571;-32.3592857142857,-12.9757142857143;-32.3592857142857,5.95285714285715;-32.2700000000000,-16.0114285714286;-32.2700000000000,-14.4042857142857;-32.2700000000000,-1.10071428571428;-32.1807142857143,-6.72571428571428;-32.0914285714286,-7.08285714285714;-31.9128571428571,-14.2257142857143;-31.8235714285714,-19.2257142857143;-31.8235714285714,11.6225000000000;-31.7342857142857,-12.3507142857143;-31.5557142857143,-4.22571428571428;-31.5557142857143,2.02428571428572;-31.5557142857143,17.1135714285714;-31.2878571428571,-10.8328571428571;-31.2878571428571,-2.61857142857142;-31.1985714285714,28.2742857142857;-31.1985714285714,37.7385714285714;-31.1092857142857,4.30107142857143;-30.9307142857143,-11.9042857142857;-30.8414285714286,-1.19000000000000;-30.8414285714286,5.59571428571429;-30.7521428571429,9.70285714285715;-30.6628571428571,-7.35071428571428;-30.6628571428571,13.3635714285714;-30.6628571428571,20.5957142857143;-30.5735714285714,-32.7971428571429;-30.5735714285714,-20.0292857142857;-30.2164285714286,15.5064285714286;-30.1271428571429,7.47071428571429;-30.1271428571429,21.2207142857143;-29.9485714285714,-18.3328571428571;-29.8592857142857,-1.54714285714285;-29.7700000000000,-4.04714285714285;-29.7700000000000,19.7028571428571;-29.6807142857143,9.97071428571429;-29.5021428571429,-16.1007142857143;-29.5021428571429,7.20285714285715;-29.5021428571429,24.0778571428572;-29.4128571428571,-8.60071428571428;-29.4128571428571,22.7385714285714;-29.0557142857143,-14.9400000000000;-29.0557142857143,7.64928571428572;-29.0557142857143,19.5242857142857;-29.0110714285714,20.0153571428571;-28.8771428571429,1.66714285714286;-28.5200000000000,-0.118571428571421;-28.4307142857143,-13.6007142857143;-28.4307142857143,-6.01142857142857;-28.3414285714286,-20.3864285714286;-28.0735714285714,-27.6185714285714;-28.0289285714286,-33.8685714285714;-27.9842857142857,-11.1900000000000;-27.8950000000000,26.4885714285714;-27.5378571428571,8.81000000000000;-27.4485714285714,-7.88642857142857;-27.4485714285714,-4.40428571428571;-27.4485714285714,2.29214285714286;-27.4485714285714,15.5064285714286;-27.4485714285714,34.3457142857143;-27.3592857142857,-18.0650000000000;-27.3592857142857,29.9707142857143;-27.1807142857143,-36.4578571428571;-27.0914285714286,-1.72571428571428;-27.0021428571429,-12.1721428571429;-26.8235714285714,10.5064285714286;-26.7789285714286,13.0957142857143;-26.6450000000000,-15.1185714285714;-26.4664285714286,17.3814285714286;-26.3771428571429,-18.6007142857143;-26.3771428571429,24.1671428571429;-26.1985714285714,13.6314285714286;-25.9307142857143,-1.10071428571428;-25.9307142857143,21.9350000000000;-25.8414285714286,16.7564285714286;-25.7521428571429,3.89928571428572;-25.3950000000000,3.81000000000000;-25.3057142857143,12.6492857142857;-25.1271428571429,-23.4221428571429;-24.9485714285714,-5.20785714285714;-24.9485714285714,7.02428571428572;-24.8592857142857,-20.4757142857143;-24.7700000000000,-9.85071428571428;-24.7700000000000,-0.654285714285706;-24.7700000000000,18.1850000000000;-24.7700000000000,34.4350000000000;-24.6807142857143,-14.9846428571429;-24.5914285714286,1.89035714285715;-24.4128571428571,19.1671428571429;-24.3235714285714,10.3725000000000;-24.3235714285714,20.1492857142857;-24.2342857142857,20.2385714285714;-24.0557142857143,-32.2614285714286;-24.0557142857143,-14.6721428571429;-24.0557142857143,-8.51142857142857;-24.0557142857143,6.48857142857143;-24.0557142857143,19.7028571428571;-23.9664285714286,-23.8685714285714;-23.9664285714286,-18.6007142857143;-23.9664285714286,-8.77928571428571;-23.9217857142857,25.6850000000000;-23.0735714285714,0.774285714285718;-22.8950000000000,14.3457142857143;-22.8057142857143,-0.654285714285706;-22.7164285714286,-11.1007142857143;-22.7164285714286,11.9350000000000;-22.6271428571429,26.4885714285714;-22.4485714285714,-25.6542857142857;-22.2700000000000,-29.6721428571429;-22.2700000000000,35.6850000000000;-22.0021428571429,-29.4935714285714;-21.9128571428571,23.3635714285714;-21.6450000000000,-26.1007142857143;-21.4664285714286,-13.6007142857143;-21.4664285714286,15.7742857142857;-21.4664285714286,31.3100000000000;-21.3771428571429,-33.3328571428571;-21.2878571428571,-5.74357142857142;-21.0200000000000,14.2564285714286;-20.4842857142857,0.595714285714294;-20.4842857142857,4.07785714285715;-20.4842857142857,13.9885714285714;-20.3057142857143,37.2028571428572;-20.1271428571429,-18.3328571428571;-20.0378571428571,-35.4757142857143;-20.0378571428571,26.6671428571429;-19.9485714285714,-17.4400000000000;-19.7700000000000,18.0957142857143;-19.5914285714286,-18.0650000000000;-19.5021428571429,-32.8864285714286;-19.5021428571429,-24.6721428571429;-19.4128571428571,-11.3685714285714;-19.4128571428571,-3.86857142857142;-19.1450000000000,22.3814285714286;-18.9664285714286,-8.15428571428571;-18.9664285714286,-7.17214285714285;-18.1628571428571,17.9171428571429;-18.1628571428571,28.1850000000000;-17.8950000000000,-2.17214285714285;-17.8950000000000,1.66714285714286;-17.8057142857143,-6.27928571428571;-17.8057142857143,2.47071428571429;-17.7164285714286,19.0778571428571;-17.6271428571429,15.6850000000000;-17.5378571428571,15.5957142857143;-17.3592857142857,-0.0292857142857059;-17.3592857142857,0.149285714285718;-17.2700000000000,-32.5292857142857;-17.2700000000000,5.77428571428572;-17.1807142857143,-23.4221428571429;-17.0914285714286,14.1671428571429;-16.9128571428571,-20.0292857142857;-16.5557142857143,-25.4757142857143;-16.3771428571429,-2.70785714285714;-16.1539285714286,-22.1721428571429;-16.1092857142857,-12.0828571428571;-16.1092857142857,12.6492857142857;-15.8414285714286,-0.832857142857137;-15.7521428571429,38.8992857142857;-15.6628571428571,-16.2792857142857;-15.5735714285714,11.5778571428571;-15.3950000000000,-7.79714285714285;-15.3950000000000,14.9707142857143;-15.1271428571429,-18.8685714285714;-15.1271428571429,-7.61857142857142;-15.1271428571429,-2.70785714285714;-15.0378571428571,-30.2971428571429;-14.5914285714286,20.4171428571429;-14.5021428571429,22.0242857142857;-14.4128571428571,-35.6542857142857;-14.3235714285714,-27.9757142857143;-14.3235714285714,-13.0650000000000;-14.2342857142857,-26.7257142857143;-13.9664285714286,-34.6721428571429;-13.9664285714286,-5.20785714285714;-13.6985714285714,-25.7435714285714;-13.6985714285714,39.1671428571429;-13.4307142857143,-19.3150000000000;-13.3414285714286,-1.63642857142857;-13.3414285714286,35.8635714285714;-12.8057142857143,-7.97571428571428;-12.7164285714286,39.8814285714286;-12.6271428571429,40.1492857142857;-12.0021428571429,-3.95785714285714;-11.9128571428571,-33.6007142857143;-11.9128571428571,-31.4578571428571;-11.8235714285714,11.1314285714286;-11.7342857142857,9.70285714285715;-11.5557142857143,-32.6185714285714;-11.5557142857143,-20.9221428571429;-11.5557142857143,-18.6007142857143;-11.5557142857143,32.7385714285714;-11.4664285714286,22.7385714285714;-11.3771428571429,40.2385714285714;-11.0200000000000,-15.2971428571429;-10.9307142857143,-34.0471428571429;-10.9307142857143,-33.7792857142857;-10.9307142857143,-11.5471428571429;-10.7521428571429,-28.3328571428571;-10.4842857142857,-8.33285714285714;-10.4842857142857,30.4171428571429;-10.2610714285714,-30.7435714285714;-10.1271428571429,-29.1364285714286;-9.94857142857143,28.8100000000000;-9.68071428571429,27.2921428571429;-9.59142857142857,-26.6364285714286;-9.50214285714286,-24.5828571428571;-9.50214285714286,10.5064285714286;-9.23428571428571,-23.6007142857143;-9.14500000000000,17.5600000000000;-9.05571428571429,-28.1542857142857;-8.96642857142857,-4.40428571428571;-8.78785714285714,8.27428571428572;-8.69857142857143,-35.8328571428571;-8.69857142857143,-16.8150000000000;-8.69857142857143,-6.45785714285714;-8.69857142857143,6.75642857142858;-8.60928571428571,-14.8507142857143;-8.60928571428571,-3.06500000000000;-8.60928571428571,8.72071428571429;-8.34142857142857,15.6850000000000;-8.16285714285714,-17.7971428571429;-8.07357142857143,-11.7257142857143;-7.80571428571429,-5.83285714285714;-7.44857142857143,-8.51142857142857;-6.64500000000000,-30.7435714285714;-6.64500000000000,-21.9489285714286;-6.64500000000000,12.0242857142857;-6.64500000000000,37.5600000000000;-6.55571428571429,-26.3685714285714;-6.55571428571429,14.1671428571429;-6.37714285714286,-0.297142857142852;-6.28785714285714,-31.8150000000000;-6.19857142857143,-26.4578571428571;-6.02000000000000,5.06000000000000;-5.75214285714286,7.29214285714286;-5.66285714285714,-27.3507142857143;-5.57357142857143,-2.97571428571428;-5.57357142857143,10.5064285714286;-5.30571428571429,-1.81500000000000;-5.21642857142857,-35.2078571428571;-5.17178571428571,-1.27928571428571;-5.03785714285714,3.45285714285715;-4.94857142857143,16.1314285714286;-4.77000000000000,19.6135714285714;-4.50214285714286,-33.1542857142857;-4.50214285714286,-8.86857142857142;-4.50214285714286,2.91714285714286;-4.32357142857143,-9.76142857142857;-4.23428571428571,-1.10071428571428;-3.96642857142857,-30.9221428571429;-3.78785714285714,5.95285714285715;-3.78785714285714,37.7385714285714;-3.43071428571429,-20.3864285714286;-3.07357142857143,41.4885714285714;-2.89500000000000,-9.22571428571428;-2.89500000000000,27.6492857142857;-2.62714285714286,23.6314285714286;-2.53785714285714,-37.7971428571429;-2.53785714285714,-5.83285714285714;-2.27000000000000,0.417142857142864;-2.27000000000000,6.04214285714286;-2.18071428571429,-15.3864285714286;-2.18071428571429,18.0957142857143;-2.18071428571429,37.3814285714286;-2.09142857142857,-10.3864285714286;-2.00214285714286,-0.564999999999998;-1.91285714285714,24.9707142857143;-1.82357142857143,11.3992857142857;-1.55571428571429,-0.207857142857137;-1.55571428571429,5.14928571428572;-1.55571428571429,33.6314285714286;-1.19857142857143,6.84571428571429;-1.02000000000000,20.4171428571429;-0.752142857142857,-30.1185714285714;-0.752142857142857,18.8100000000000;-0.662857142857142,-20.8328571428571;-0.662857142857142,-0.0292857142857059;-0.484285714285711,11.8457142857143;-0.484285714285711,17.1582142857143;-0.484285714285711,22.1582142857143;-0.395000000000003,29.5242857142857;-0.305714285714288,-13.6900000000000;-0.305714285714288,-0.966785714285706;0.0514285714285734,10.5064285714286;0.140714285714289,-4.76142857142857;0.140714285714289,2.47071428571429;0.140714285714289,29.3457142857143;0.140714285714289,30.6850000000000;0.229999999999997,-20.1185714285714;0.229999999999997,-12.6185714285714;0.229999999999997,8.36357142857143;0.319285714285712,0.238571428571433;0.319285714285712,24.5242857142857;0.408571428571428,-7.17214285714285;0.408571428571428,16.5778571428571;0.676428571428573,-12.8864285714286;0.765714285714289,1.84571428571429;0.855000000000004,24.2564285714286;0.944285714285712,40.9528571428572;1.03357142857143,18.6314285714286;1.21214285714286,-19.5828571428571;1.48000000000000,-20.2078571428571;1.56928571428571,-29.6721428571429;1.56928571428571,9.70285714285715;1.56928571428571,18.8100000000000;1.56928571428571,31.6671428571429;1.74785714285714,-21.7257142857143;1.74785714285714,0.774285714285718;1.83714285714286,-35.4757142857143;2.01571428571429,-0.475714285714282;2.10500000000000,-37.7971428571429;2.28357142857143,-8.33285714285714;2.28357142857143,1.39928571428572;2.46214285714286,10.5957142857143;2.46214285714286,28.5421428571429;2.55142857142857,21.3992857142857;2.81928571428571,-16.5471428571429;2.99785714285714,-0.207857142857137;2.99785714285714,26.2207142857143;3.08714285714286,-17.7078571428571;3.08714285714286,5.14928571428572;3.17642857142857,-14.3150000000000;3.17642857142857,10.6850000000000;3.35500000000000,-0.564999999999998;3.44428571428571,-7.35071428571428;3.62285714285714,31.6671428571429;3.71214285714286,-1.45785714285714;3.71214285714286,2.02428571428572;3.71214285714286,16.8457142857143;3.89071428571429,-31.7257142857143;3.89071428571429,-5.74357142857142;3.98000000000000,-39.5828571428571;4.06928571428571,-0.743571428571421;4.15857142857143,2.29214285714286;4.15857142857143,3.63142857142858;4.42642857142857,-1.36857142857142;4.42642857142857,0.0600000000000023;4.60500000000000,24.6135714285714;4.69428571428571,-14.9400000000000;4.69428571428571,-7.88642857142857;4.87285714285714,35.5064285714286;5.05142857142857,1.93500000000000;5.05142857142857,29.0778571428572;5.14071428571429,1.66714285714286;5.23000000000000,-33.9578571428571;5.31928571428571,-38.6007142857143;5.31928571428571,-34.9400000000000;5.40857142857143,7.64928571428572;5.49785714285714,16.3992857142857;5.58714285714286,-40.2078571428571;5.67642857142857,-11.1007142857143;5.67642857142857,11.3992857142857;5.94428571428571,-37.5292857142857;5.94428571428571,19.4350000000000;6.16750000000000,13.6314285714286;6.30142857142857,-6.63642857142857;6.30142857142857,31.0421428571429;6.43535714285714,-31.3685714285714;6.56928571428571,-0.743571428571421;6.56928571428571,2.02428571428572;6.56928571428571,17.2921428571429;6.65857142857143,-17.1721428571429;6.74785714285714,-0.743571428571421;6.92642857142857,33.4528571428572;7.10500000000000,-29.1364285714286;7.46214285714286,-10.8328571428571;7.73000000000000,-38.8685714285714;7.90857142857143,-17.5292857142857;7.90857142857143,-16.9042857142857;7.90857142857143,33.0957142857143;8.08714285714286,-39.8507142857143;8.08714285714286,6.93500000000000;8.17642857142857,-37.0828571428571;8.26571428571429,-19.3150000000000;8.35500000000000,-25.6542857142857;8.35500000000000,-0.564999999999998;8.35500000000000,-0.475714285714282;8.44428571428571,-1.45785714285714;8.44428571428571,20.8635714285714;8.53357142857143,-36.6364285714286;8.62285714285715,-12.6185714285714;8.98000000000000,-8.51142857142857;9.06928571428572,-19.0025000000000;9.06928571428572,0.327857142857148;9.15857142857143,-38.6900000000000;9.15857142857143,-13.3328571428571;9.51571428571429,15.4171428571429;9.60500000000000,-9.22571428571428;9.87285714285715,25.5064285714286;9.96214285714286,-35.8328571428571;10.1407142857143,17.1135714285714;10.3192857142857,24.1671428571429;10.6764285714286,-38.3328571428571;10.7657142857143,-33.6900000000000;10.7657142857143,-28.9578571428571;10.8550000000000,-39.8507142857143;11.0335714285714,19.7921428571429;11.2121428571429,16.6671428571429;11.3014285714286,25.4171428571429;11.3907142857143,27.2028571428572;11.5692857142857,-23.8685714285714;11.6585714285714,-14.3150000000000;11.9264285714286,26.7564285714286;12.0157142857143,-35.9221428571429;12.0157142857143,33.0064285714286;12.0157142857143,41.3992857142857;12.1050000000000,-1.54714285714285;12.1050000000000,6.39928571428572;12.3728571428572,3.27428571428572;12.4621428571429,-14.6721428571429;12.6407142857143,-13.2435714285714;12.9085714285714,-5.11857142857142;13.0871428571429,-37.5292857142857;13.0871428571429,26.1760714285714;13.2657142857143,-30.0292857142857;13.2657142857143,-12.9757142857143;13.4442857142857,-39.3150000000000;13.4442857142857,-38.3328571428571;13.8014285714286,-33.1542857142857;14.0692857142857,-33.9578571428571;14.0692857142857,-26.6364285714286;14.0692857142857,-6.81500000000000;14.2032142857143,10.4171428571429;14.2925000000000,11.7564285714286;14.5157142857143,31.9350000000000;14.6050000000000,-7.08285714285714;14.9621428571429,5.77428571428572;14.9621428571429,10.4171428571429;15.1407142857143,7.64928571428572;15.5871428571429,-25.3864285714286;15.5871428571429,12.7385714285714;15.5871428571429,33.4528571428572;15.9442857142857,-19.8507142857143;15.9442857142857,-10.2971428571429;16.2121428571429,12.0242857142857;16.3014285714286,-20.7435714285714;16.3907142857143,-23.0650000000000;16.3907142857143,15.8635714285714;16.6585714285714,20.8635714285714;16.7478571428572,12.1582142857143;16.8371428571429,21.2207142857143;17.4621428571429,-0.0292857142857059;17.5514285714286,18.8100000000000;17.6407142857143,15.5064285714286;17.6407142857143,26.4885714285714;17.8192857142857,41.1314285714286;17.9085714285714,37.1135714285714;17.9978571428572,-32.2614285714286;17.9978571428572,-16.6364285714286;18.3550000000000,38.9885714285714;18.5335714285714,8.63142857142858;18.6228571428572,12.0242857142857;18.7121428571429,5.23857142857143;18.7567857142857,-1.90428571428571;18.8014285714286,25.4171428571429;18.8907142857143,-21.9935714285714;18.9800000000000,-0.654285714285706;19.0692857142857,-13.7792857142857;19.1585714285714,8.54214285714286;19.3371428571429,22.5600000000000;19.6050000000000,16.1314285714286;19.6050000000000,18.7207142857143;19.6942857142857,-19.4042857142857;19.6942857142857,0.506428571428579;19.7835714285714,10.6403571428571;19.7835714285714,24.7921428571429;19.8728571428572,13.9885714285714;19.9175000000000,15.0600000000000;20.0067857142857,16.1314285714286;20.1407142857143,22.5600000000000;20.1407142857143,31.7564285714286;20.3192857142857,10.4171428571429;20.4978571428572,12.6492857142857;20.5425000000000,17.2921428571429;20.6764285714286,18.9885714285714;20.7657142857143,12.0242857142857;20.8550000000000,19.0778571428571;21.0335714285714,3.36357142857143;21.1228571428572,9.97071428571429;21.1228571428572,15.6850000000000;21.3014285714286,-11.9935714285714;21.3014285714286,16.7564285714286;21.4800000000000,-29.4935714285714;21.6585714285714,-32.5292857142857;21.9264285714286,-13.1542857142857;22.0157142857143,22.5153571428572;22.1050000000000,-18.4221428571429;22.1050000000000,18.0957142857143;22.9085714285714,-36.8150000000000;22.9085714285714,14.6135714285714;23.2657142857143,19.0778571428571;23.8014285714286,2.11357142857143;23.8907142857143,14.5242857142857;23.8907142857143,24.8814285714286;23.9800000000000,3.45285714285715;24.0692857142857,7.47071428571429;24.0692857142857,13.4528571428571;24.1585714285714,11.2207142857143;24.3371428571429,10.9528571428571;24.6942857142857,-17.5292857142857;24.6942857142857,6.93500000000000;24.9621428571429,40.6850000000000;25.0514285714286,8.81000000000000;25.2300000000000,-5.29714285714285;25.2300000000000,39.9707142857143;25.3192857142857,5.46178571428572;25.4978571428572,12.1135714285714;25.5871428571429,12.6492857142857;25.6764285714286,16.4885714285714;25.8550000000000,22.1135714285714;25.8550000000000,28.6314285714286;25.9442857142857,5.23857142857143;26.0335714285714,0.685000000000002;26.0335714285714,19.9707142857143;26.1228571428572,-21.7703571428571;26.1228571428572,31.0421428571429;26.2567857142857,4.97071428571429;26.3014285714286,-12.7078571428571;26.3907142857143,-20.8328571428571;26.3907142857143,24.7921428571429;26.5692857142857,-20.7435714285714;26.6585714285714,-31.4578571428571;26.6585714285714,5.86357142857143;26.7478571428572,11.7564285714286;26.7478571428572,41.6671428571429;27.1050000000000,-39.4935714285714;27.1050000000000,13.2742857142857;27.1050000000000,19.1671428571429;27.1942857142857,3.09571428571429;27.2389285714286,-28.2435714285714;27.5514285714286,6.31000000000000;27.8192857142857,-23.8685714285714;27.8192857142857,13.0064285714286;27.9978571428572,-5.74357142857142;28.5335714285714,-24.0025000000000;28.5335714285714,8.81000000000000;28.5335714285714,14.4350000000000;28.7121428571429,-40.5650000000000;28.8014285714286,16.3100000000000;28.8907142857143,8.63142857142858;29.2478571428572,-16.9042857142857;29.2478571428572,24.7921428571429;29.4264285714286,11.9350000000000;29.4264285714286,24.5242857142857;29.4264285714286,32.3814285714286;29.6050000000000,19.5242857142857;29.7835714285714,26.8457142857143;29.9621428571429,0.0153571428571482;29.9621428571429,13.4528571428571;30.0514285714286,16.8457142857143;30.1407142857143,-21.4578571428571;30.3192857142857,20.8189285714286;30.3192857142857,22.7385714285714;30.3192857142857,27.7385714285714;30.6764285714286,1.04214285714286;30.7657142857143,11.5778571428571;30.9442857142857,-27.7971428571429;30.9442857142857,32.3814285714286;31.0335714285714,30.0600000000000;31.1228571428572,4.61357142857143;31.4800000000000,-37.0828571428571;31.9264285714286,40.2385714285714;32.1050000000000,6.57785714285715;32.2835714285714,24.7921428571429;32.3728571428572,15.5957142857143;32.6407142857143,10.0600000000000;33.0871428571429,-1.27928571428571;33.0871428571429,5.41714285714286;33.2657142857143,10.0600000000000;33.3550000000000,-39.9400000000000;33.8907142857143,-10.4757142857143;33.8907142857143,25.9528571428572;34.0692857142857,-36.7257142857143;34.0692857142857,-36.3685714285714;34.1585714285714,4.25642857142858;34.2478571428572,-3.24357142857142;34.2478571428572,38.1850000000000;34.6050000000000,15.4171428571429;34.6050000000000,19.2564285714286;34.6942857142857,-23.6900000000000;34.6942857142857,-22.9757142857143;34.7835714285714,-12.4400000000000;34.8728571428572,-3.86857142857142;35.4085714285714,-18.5114285714286;35.4085714285714,2.64928571428572;35.4085714285714,3.89928571428572;35.4978571428572,-24.0471428571429;35.9442857142857,14.4350000000000;36.0782142857143,-10.0292857142857;36.4800000000000,27.2921428571429;36.5692857142857,-24.9400000000000;36.6585714285714,19.0778571428571;36.7478571428572,22.1135714285714;36.8371428571429,1.48857142857143;36.9264285714286,-20.7435714285714;37.0157142857143,37.4707142857143;37.4621428571429,-27.7078571428571;37.8192857142857,4.34571428571429;37.9978571428572,34.2117857142857;38.4442857142857,20.7742857142857;38.8907142857143,-15.9221428571429;38.9800000000000,13.2742857142857;39.1139285714286,32.0242857142857;39.4264285714286,-21.5471428571429;39.5157142857143,15.4171428571429;39.7835714285714,29.6135714285714;41.0782142857143,20.8635714285714;41.1228571428572,36.8457142857143;41.4800000000000,-39.6721428571429;42.2835714285714,7.38142857142858;42.5514285714286,15.7742857142857;42.9978571428572,11.8457142857143;43.3550000000000,38.7207142857143;43.5335714285714,22.9171428571429;43.5335714285714,41.2207142857143;43.8907142857143,-25.4757142857143;44.1585714285714,36.8457142857143;44.2478571428572,1.75642857142858;44.7835714285714,36.8457142857143;44.8728571428572,37.5600000000000;45.7657142857143,-22.1721428571429;46.3014285714286,-32.6185714285714;46.5692857142857,38.2742857142857;47.2835714285714,-15.6542857142857;47.4621428571429,-15.2971428571429;47.5514285714286,-19.4042857142857;47.6407142857143,-39.8507142857143;47.7300000000000,-24.4042857142857;47.7300000000000,40.1492857142857;48.1764285714286,30.3278571428572;48.2657142857143,28.9885714285714;49.3371428571429,40.5957142857143;49.4264285714286,-33.5114285714286;49.4264285714286,5.14928571428572;49.6050000000000,-35.9221428571429;49.7835714285714,29.0778571428572;49.8728571428572,-34.4042857142857;50.0514285714286,14.3457142857143;50.3192857142857,39.5242857142857;50.4978571428572,-8.06500000000000;50.5871428571429,-6.99357142857142;50.6764285714286,-24.1364285714286;50.7657142857143,-13.9578571428571;50.9442857142857,-35.9221428571429;50.9442857142857,-24.6721428571429;50.9442857142857,38.3635714285714;51.0335714285714,41.6671428571429;51.1228571428572,-31.3685714285714;51.1228571428572,8.72071428571429;51.2121428571429,-35.0292857142857;51.2121428571429,7.11357142857143;51.2121428571429,28.8992857142857;51.3014285714286,23.9885714285714;51.4800000000000,34.0778571428572;51.6585714285714,-35.0292857142857;51.8371428571429,10.5064285714286;51.9264285714286,-37.2614285714286;51.9264285714286,-36.1007142857143;51.9264285714286,5.77428571428572;52.0157142857143,39.5689285714286;52.1050000000000,-38.3328571428571;52.1050000000000,-32.2614285714286;52.1942857142857,-4.85071428571428;52.1942857142857,8.85464285714286;52.5067857142857,33.8992857142857;52.6407142857143,-35.8328571428571;52.9085714285714,-7.35071428571428];
spots = [-47.0914285714286,-1.72571428571428;-47.0021428571429,-33.1542857142857;-46.7342857142857,-1.19000000000000;-46.7342857142857,25.0600000000000;-46.1985714285714,23.8992857142857;-45.9307142857143,26.2207142857143;-45.8414285714286,0.417142857142864;-45.3950000000000,-32.1721428571429;-45.1271428571429,0.238571428571433;-44.7700000000000,34.2564285714286;-44.6807142857143,3.81000000000000;-44.5914285714286,-9.35964285714285;-44.5914285714286,3.18500000000000;-44.4128571428572,34.7028571428572;-44.1450000000000,0.238571428571433;-43.9664285714286,31.9350000000000;-43.8771428571429,-27.6632142857143;-43.6985714285714,6.31000000000000;-43.6092857142857,3.45285714285715;-42.8950000000000,1.04214285714286;-42.7164285714286,-11.3685714285714;-42.4485714285714,-1.27928571428571;-42.4485714285714,4.97071428571429;-42.0914285714286,-6.01142857142857;-42.0914285714286,1.08678571428572;-41.7342857142857,-2.26142857142857;-41.3771428571429,-25.5650000000000;-41.2878571428572,3.00642857142858;-41.1985714285714,28.4528571428572;-41.0200000000000,2.64928571428572;-40.4842857142857,-12.8864285714286;-40.1271428571429,-9.67214285714285;-40.0378571428572,6.13142857142858;-39.8592857142857,-3.33285714285714;-39.8146428571429,-16.9935714285714;-39.7700000000000,-4.85071428571428;-39.6807142857143,-9.58285714285714;-39.5914285714286,-11.6364285714286;-39.5914285714286,-4.49357142857142;-39.5021428571429,-25.2078571428571;-39.1450000000000,-24.4042857142857;-39.1450000000000,3.98857142857143;-39.1450000000000,19.3457142857143;-39.0557142857143,-13.7792857142857;-39.0557142857143,26.6671428571429;-38.8771428571429,30.5957142857143;-38.7878571428572,-20.2078571428571;-38.7878571428572,-17.9757142857143;-38.7878571428572,-17.9757142857143;-38.3414285714286,22.6046428571429;-38.1628571428572,-12.2614285714286;-38.0735714285714,-12.2614285714286;-38.0735714285714,23.4528571428572;-37.9842857142857,-7.79714285714285;-37.9842857142857,6.13142857142858;-37.8057142857143,-5.47571428571428;-37.5378571428572,13.8100000000000;-37.4485714285714,-23.8685714285714;-37.0914285714286,-11.9042857142857;-37.0914285714286,-10.1185714285714;-37.0914285714286,1.75642857142858;-37.0914285714286,6.13142857142858;-36.9128571428572,-27.4400000000000;-36.9128571428572,-18.5114285714286;-36.9128571428572,-3.51142857142857;-36.7342857142857,-0.743571428571421;-36.5557142857143,4.16714285714286;-36.4664285714286,-8.24357142857142;-36.3771428571429,-7.35071428571428;-36.3771428571429,31.9350000000000;-36.1985714285714,19.4350000000000;-36.1092857142857,-15.3864285714286;-36.1092857142857,-14.5828571428571;-36.1092857142857,6.66714285714286;-36.0200000000000,22.6492857142857;-35.9307142857143,-18.7792857142857;-35.7521428571429,1.75642857142858;-35.6628571428572,-13.5114285714286;-35.5735714285714,6.57785714285715;-35.4842857142857,-20.5650000000000;-35.3950000000000,1.62250000000000;-35.3950000000000,32.6492857142857;-35.3057142857143,-12.2614285714286;-35.2164285714286,-23.4221428571429;-35.1271428571429,-18.6007142857143;-35.1271428571429,-2.79714285714285;-35.0378571428572,2.47071428571429;-34.8592857142857,1.04214285714286;-34.7700000000000,-19.3150000000000;-34.6807142857143,7.73857142857143;-34.5914285714286,-10.5650000000000;-34.5914285714286,-0.922142857142852;-34.5021428571429,14.9707142857143;-34.3235714285714,-34.1364285714286;-34.3235714285714,5.41714285714286;-34.2342857142857,-16.5471428571429;-34.1450000000000,-29.4935714285714;-34.0557142857143,5.68500000000000;-33.9664285714286,-4.94000000000000;-33.8771428571429,22.6492857142857;-33.6092857142857,-17.6185714285714;-33.6092857142857,13.0064285714286;-33.6092857142857,17.3814285714286;-33.5200000000000,-15.9221428571429;-33.3414285714286,12.0242857142857;-33.3414285714286,25.5957142857143;-33.1628571428572,-24.4935714285714;-33.1628571428572,5.23857142857143;-32.9842857142857,-17.3507142857143;-32.8057142857143,8.89928571428572;-32.6271428571429,-21.4578571428571;-32.5378571428572,-25.0292857142857;-32.5378571428572,-13.9578571428571;-32.3592857142857,-12.9757142857143;-32.3592857142857,5.95285714285715;-32.2700000000000,-16.0114285714286;-32.2700000000000,-14.4042857142857;-32.2700000000000,-1.10071428571428;-32.1807142857143,-6.72571428571428;-32.0914285714286,-7.08285714285714;-31.9128571428571,-14.2257142857143;-31.8235714285714,-19.2257142857143;-31.8235714285714,11.6225000000000;-31.7342857142857,-12.3507142857143;-31.5557142857143,-4.22571428571428;-31.5557142857143,2.02428571428572;-31.5557142857143,17.1135714285714;-31.2878571428571,-10.8328571428571;-31.2878571428571,-2.61857142857142;-31.1985714285714,28.2742857142857;-31.1092857142857,4.30107142857143;-30.9307142857143,-11.9042857142857;-30.8414285714286,-1.19000000000000;-30.8414285714286,5.59571428571429;-30.7521428571429,9.70285714285715;-30.6628571428571,-7.35071428571428;-30.6628571428571,13.3635714285714;-30.6628571428571,20.5957142857143;-30.5735714285714,-32.7971428571429;-30.5735714285714,-20.0292857142857;-30.2164285714286,15.5064285714286;-30.1271428571429,7.47071428571429;-30.1271428571429,21.2207142857143;-29.9485714285714,-18.3328571428571;-29.8592857142857,-1.54714285714285;-29.7700000000000,-4.04714285714285;-29.7700000000000,19.7028571428571;-29.6807142857143,9.97071428571429;-29.5021428571429,-16.1007142857143;-29.5021428571429,7.20285714285715;-29.5021428571429,24.0778571428572;-29.4128571428571,-8.60071428571428;-29.4128571428571,22.7385714285714;-29.0557142857143,-14.9400000000000;-29.0557142857143,7.64928571428572;-29.0557142857143,19.5242857142857;-29.0110714285714,20.0153571428571;-28.8771428571429,1.66714285714286;-28.5200000000000,-0.118571428571421;-28.4307142857143,-13.6007142857143;-28.4307142857143,-6.01142857142857;-28.3414285714286,-20.3864285714286;-28.0735714285714,-27.6185714285714;-28.0289285714286,-33.8685714285714;-27.9842857142857,-11.1900000000000;-27.8950000000000,26.4885714285714;-27.5378571428571,8.81000000000000;-27.4485714285714,-7.88642857142857;-27.4485714285714,-4.40428571428571;-27.4485714285714,2.29214285714286;-27.4485714285714,15.5064285714286;-27.4485714285714,34.3457142857143;-27.3592857142857,-18.0650000000000;-27.3592857142857,29.9707142857143;-27.0914285714286,-1.72571428571428;-27.0021428571429,-12.1721428571429;-26.8235714285714,10.5064285714286;-26.7789285714286,13.0957142857143;-26.6450000000000,-15.1185714285714;-26.4664285714286,17.3814285714286;-26.3771428571429,-18.6007142857143;-26.3771428571429,24.1671428571429;-26.1985714285714,13.6314285714286;-25.9307142857143,-1.10071428571428;-25.9307142857143,21.9350000000000;-25.8414285714286,16.7564285714286;-25.7521428571429,3.89928571428572;-25.3950000000000,3.81000000000000;-25.3057142857143,12.6492857142857;-25.1271428571429,-23.4221428571429;-24.9485714285714,-5.20785714285714;-24.9485714285714,7.02428571428572;-24.8592857142857,-20.4757142857143;-24.7700000000000,-9.85071428571428;-24.7700000000000,-0.654285714285706;-24.7700000000000,18.1850000000000;-24.7700000000000,34.4350000000000;-24.6807142857143,-14.9846428571429;-24.5914285714286,1.89035714285715;-24.4128571428571,19.1671428571429;-24.3235714285714,10.3725000000000;-24.3235714285714,20.1492857142857;-24.2342857142857,20.2385714285714;-24.0557142857143,-32.2614285714286;-24.0557142857143,-14.6721428571429;-24.0557142857143,-8.51142857142857;-24.0557142857143,6.48857142857143;-24.0557142857143,19.7028571428571;-23.9664285714286,-23.8685714285714;-23.9664285714286,-18.6007142857143;-23.9664285714286,-8.77928571428571;-23.9217857142857,25.6850000000000;-23.0735714285714,0.774285714285718;-22.8950000000000,14.3457142857143;-22.8057142857143,-0.654285714285706;-22.7164285714286,-11.1007142857143;-22.7164285714286,11.9350000000000;-22.6271428571429,26.4885714285714;-22.4485714285714,-25.6542857142857;-22.2700000000000,-29.6721428571429;-22.2700000000000,35.6850000000000;-22.0021428571429,-29.4935714285714;-21.9128571428571,23.3635714285714;-21.6450000000000,-26.1007142857143;-21.4664285714286,-13.6007142857143;-21.4664285714286,15.7742857142857;-21.4664285714286,31.3100000000000;-21.3771428571429,-33.3328571428571;-21.2878571428571,-5.74357142857142;-21.0200000000000,14.2564285714286;-20.4842857142857,0.595714285714294;-20.4842857142857,4.07785714285715;-20.4842857142857,13.9885714285714;-20.1271428571429,-18.3328571428571;-20.0378571428571,-35.4757142857143;-20.0378571428571,26.6671428571429;-19.9485714285714,-17.4400000000000;-19.7700000000000,18.0957142857143;-19.5914285714286,-18.0650000000000;-19.5021428571429,-32.8864285714286;-19.5021428571429,-24.6721428571429;-19.4128571428571,-11.3685714285714;-19.4128571428571,-3.86857142857142;-19.1450000000000,22.3814285714286;-18.9664285714286,-8.15428571428571;-18.9664285714286,-7.17214285714285;-18.1628571428571,17.9171428571429;-18.1628571428571,28.1850000000000;-17.8950000000000,-2.17214285714285;-17.8950000000000,1.66714285714286;-17.8057142857143,-6.27928571428571;-17.8057142857143,2.47071428571429;-17.7164285714286,19.0778571428571;-17.6271428571429,15.6850000000000;-17.5378571428571,15.5957142857143;-17.3592857142857,-0.0292857142857059;-17.3592857142857,0.149285714285718;-17.2700000000000,-32.5292857142857;-17.2700000000000,5.77428571428572;-17.1807142857143,-23.4221428571429;-17.0914285714286,14.1671428571429;-16.9128571428571,-20.0292857142857;-16.5557142857143,-25.4757142857143;-16.3771428571429,-2.70785714285714;-16.1539285714286,-22.1721428571429;-16.1092857142857,-12.0828571428571;-16.1092857142857,12.6492857142857;-15.8414285714286,-0.832857142857137;-15.6628571428571,-16.2792857142857;-15.5735714285714,11.5778571428571;-15.3950000000000,-7.79714285714285;-15.3950000000000,14.9707142857143;-15.1271428571429,-18.8685714285714;-15.1271428571429,-7.61857142857142;-15.1271428571429,-2.70785714285714;-15.0378571428571,-30.2971428571429;-14.5914285714286,20.4171428571429;-14.5021428571429,22.0242857142857;-14.4128571428571,-35.6542857142857;-14.3235714285714,-27.9757142857143;-14.3235714285714,-13.0650000000000;-14.2342857142857,-26.7257142857143;-13.9664285714286,-34.6721428571429;-13.9664285714286,-5.20785714285714;-13.6985714285714,-25.7435714285714;-13.4307142857143,-19.3150000000000;-13.3414285714286,-1.63642857142857;-12.8057142857143,-7.97571428571428;-12.0021428571429,-3.95785714285714;-11.9128571428571,-33.6007142857143;-11.9128571428571,-31.4578571428571;-11.8235714285714,11.1314285714286;-11.7342857142857,9.70285714285715;-11.5557142857143,-32.6185714285714;-11.5557142857143,-20.9221428571429;-11.5557142857143,-18.6007142857143;-11.5557142857143,32.7385714285714;-11.4664285714286,22.7385714285714;-11.0200000000000,-15.2971428571429;-10.9307142857143,-34.0471428571429;-10.9307142857143,-33.7792857142857;-10.9307142857143,-11.5471428571429;-10.7521428571429,-28.3328571428571;-10.4842857142857,-8.33285714285714;-10.4842857142857,30.4171428571429;-10.2610714285714,-30.7435714285714;-10.1271428571429,-29.1364285714286;-9.94857142857143,28.8100000000000;-9.68071428571429,27.2921428571429;-9.59142857142857,-26.6364285714286;-9.50214285714286,-24.5828571428571;-9.50214285714286,10.5064285714286;-9.23428571428571,-23.6007142857143;-9.14500000000000,17.5600000000000;-9.05571428571429,-28.1542857142857;-8.96642857142857,-4.40428571428571;-8.78785714285714,8.27428571428572;-8.69857142857143,-16.8150000000000;-8.69857142857143,-6.45785714285714;-8.69857142857143,6.75642857142858;-8.60928571428571,-14.8507142857143;-8.60928571428571,-3.06500000000000;-8.60928571428571,8.72071428571429;-8.34142857142857,15.6850000000000;-8.16285714285714,-17.7971428571429;-8.07357142857143,-11.7257142857143;-7.80571428571429,-5.83285714285714;-7.44857142857143,-8.51142857142857;-6.64500000000000,-30.7435714285714;-6.64500000000000,-21.9489285714286;-6.64500000000000,12.0242857142857;-6.55571428571429,-26.3685714285714;-6.55571428571429,14.1671428571429;-6.37714285714286,-0.297142857142852;-6.28785714285714,-31.8150000000000;-6.19857142857143,-26.4578571428571;-6.02000000000000,5.06000000000000;-5.75214285714286,7.29214285714286;-5.66285714285714,-27.3507142857143;-5.57357142857143,-2.97571428571428;-5.57357142857143,10.5064285714286;-5.30571428571429,-1.81500000000000;-5.21642857142857,-35.2078571428571;-5.17178571428571,-1.27928571428571;-5.03785714285714,3.45285714285715;-4.94857142857143,16.1314285714286;-4.77000000000000,19.6135714285714;-4.50214285714286,-33.1542857142857;-4.50214285714286,-8.86857142857142;-4.50214285714286,2.91714285714286;-4.32357142857143,-9.76142857142857;-4.23428571428571,-1.10071428571428;-3.96642857142857,-30.9221428571429;-3.78785714285714,5.95285714285715;-3.43071428571429,-20.3864285714286;-2.89500000000000,-9.22571428571428;-2.89500000000000,27.6492857142857;-2.62714285714286,23.6314285714286;-2.53785714285714,-5.83285714285714;-2.27000000000000,0.417142857142864;-2.27000000000000,6.04214285714286;-2.18071428571429,-15.3864285714286;-2.18071428571429,18.0957142857143;-2.09142857142857,-10.3864285714286;-2.00214285714286,-0.564999999999998;-1.91285714285714,24.9707142857143;-1.82357142857143,11.3992857142857;-1.55571428571429,-0.207857142857137;-1.55571428571429,5.14928571428572;-1.55571428571429,33.6314285714286;-1.19857142857143,6.84571428571429;-1.02000000000000,20.4171428571429;-0.752142857142857,-30.1185714285714;-0.752142857142857,18.8100000000000;-0.662857142857142,-20.8328571428571;-0.662857142857142,-0.0292857142857059;-0.484285714285711,11.8457142857143;-0.484285714285711,17.1582142857143;-0.484285714285711,22.1582142857143;-0.395000000000003,29.5242857142857;-0.305714285714288,-13.6900000000000;-0.305714285714288,-0.966785714285706;0.0514285714285734,10.5064285714286;0.140714285714289,-4.76142857142857;0.140714285714289,2.47071428571429;0.140714285714289,29.3457142857143;0.140714285714289,30.6850000000000;0.229999999999997,-20.1185714285714;0.229999999999997,-12.6185714285714;0.229999999999997,8.36357142857143;0.319285714285712,0.238571428571433;0.319285714285712,24.5242857142857;0.408571428571428,-7.17214285714285;0.408571428571428,16.5778571428571;0.676428571428573,-12.8864285714286;0.765714285714289,1.84571428571429;0.855000000000004,24.2564285714286;1.03357142857143,18.6314285714286;1.21214285714286,-19.5828571428571;1.48000000000000,-20.2078571428571;1.56928571428571,-29.6721428571429;1.56928571428571,9.70285714285715;1.56928571428571,18.8100000000000;1.56928571428571,31.6671428571429;1.74785714285714,-21.7257142857143;1.74785714285714,0.774285714285718;1.83714285714286,-35.4757142857143;2.01571428571429,-0.475714285714282;2.28357142857143,-8.33285714285714;2.28357142857143,1.39928571428572;2.46214285714286,10.5957142857143;2.46214285714286,28.5421428571429;2.55142857142857,21.3992857142857;2.81928571428571,-16.5471428571429;2.99785714285714,-0.207857142857137;2.99785714285714,26.2207142857143;3.08714285714286,-17.7078571428571;3.08714285714286,5.14928571428572;3.17642857142857,-14.3150000000000;3.17642857142857,10.6850000000000;3.35500000000000,-0.564999999999998;3.44428571428571,-7.35071428571428;3.62285714285714,31.6671428571429;3.71214285714286,-1.45785714285714;3.71214285714286,2.02428571428572;3.71214285714286,16.8457142857143;3.89071428571429,-31.7257142857143;3.89071428571429,-5.74357142857142;4.06928571428571,-0.743571428571421;4.15857142857143,2.29214285714286;4.15857142857143,3.63142857142858;4.42642857142857,-1.36857142857142;4.42642857142857,0.0600000000000023;4.60500000000000,24.6135714285714;4.69428571428571,-14.9400000000000;4.69428571428571,-7.88642857142857;4.87285714285714,35.5064285714286;5.05142857142857,1.93500000000000;5.05142857142857,29.0778571428572;5.14071428571429,1.66714285714286;5.23000000000000,-33.9578571428571;5.31928571428571,-34.9400000000000;5.40857142857143,7.64928571428572;5.49785714285714,16.3992857142857;5.67642857142857,-11.1007142857143;5.67642857142857,11.3992857142857;5.94428571428571,19.4350000000000;6.16750000000000,13.6314285714286;6.30142857142857,-6.63642857142857;6.30142857142857,31.0421428571429;6.43535714285714,-31.3685714285714;6.56928571428571,-0.743571428571421;6.56928571428571,2.02428571428572;6.56928571428571,17.2921428571429;6.65857142857143,-17.1721428571429;6.74785714285714,-0.743571428571421;6.92642857142857,33.4528571428572;7.10500000000000,-29.1364285714286;7.46214285714286,-10.8328571428571;7.90857142857143,-17.5292857142857;7.90857142857143,-16.9042857142857;7.90857142857143,33.0957142857143;8.08714285714286,6.93500000000000;8.26571428571429,-19.3150000000000;8.35500000000000,-25.6542857142857;8.35500000000000,-0.564999999999998;8.35500000000000,-0.475714285714282;8.44428571428571,-1.45785714285714;8.44428571428571,20.8635714285714;8.62285714285715,-12.6185714285714;8.98000000000000,-8.51142857142857;9.06928571428572,-19.0025000000000;9.06928571428572,0.327857142857148;9.15857142857143,-13.3328571428571;9.51571428571429,15.4171428571429;9.60500000000000,-9.22571428571428;9.87285714285715,25.5064285714286;10.1407142857143,17.1135714285714;10.3192857142857,24.1671428571429;10.7657142857143,-33.6900000000000;10.7657142857143,-28.9578571428571;11.0335714285714,19.7921428571429;11.2121428571429,16.6671428571429;11.3014285714286,25.4171428571429;11.3907142857143,27.2028571428572;11.5692857142857,-23.8685714285714;11.6585714285714,-14.3150000000000;11.9264285714286,26.7564285714286;12.0157142857143,33.0064285714286;12.1050000000000,-1.54714285714285;12.1050000000000,6.39928571428572;12.3728571428572,3.27428571428572;12.4621428571429,-14.6721428571429;12.6407142857143,-13.2435714285714;12.9085714285714,-5.11857142857142;13.0871428571429,26.1760714285714;13.2657142857143,-30.0292857142857;13.2657142857143,-12.9757142857143;13.8014285714286,-33.1542857142857;14.0692857142857,-33.9578571428571;14.0692857142857,-26.6364285714286;14.0692857142857,-6.81500000000000;14.2032142857143,10.4171428571429;14.2925000000000,11.7564285714286;14.5157142857143,31.9350000000000;14.6050000000000,-7.08285714285714;14.9621428571429,5.77428571428572;14.9621428571429,10.4171428571429;15.1407142857143,7.64928571428572;15.5871428571429,-25.3864285714286;15.5871428571429,12.7385714285714;15.5871428571429,33.4528571428572;15.9442857142857,-19.8507142857143;15.9442857142857,-10.2971428571429;16.2121428571429,12.0242857142857;16.3014285714286,-20.7435714285714;16.3907142857143,-23.0650000000000;16.3907142857143,15.8635714285714;16.6585714285714,20.8635714285714;16.7478571428572,12.1582142857143;16.8371428571429,21.2207142857143;17.4621428571429,-0.0292857142857059;17.5514285714286,18.8100000000000;17.6407142857143,15.5064285714286;17.6407142857143,26.4885714285714;17.9978571428572,-32.2614285714286;17.9978571428572,-16.6364285714286;18.5335714285714,8.63142857142858;18.6228571428572,12.0242857142857;18.7121428571429,5.23857142857143;18.7567857142857,-1.90428571428571;18.8014285714286,25.4171428571429;18.8907142857143,-21.9935714285714;18.9800000000000,-0.654285714285706;19.0692857142857,-13.7792857142857;19.1585714285714,8.54214285714286;19.3371428571429,22.5600000000000;19.6050000000000,16.1314285714286;19.6050000000000,18.7207142857143;19.6942857142857,-19.4042857142857;19.6942857142857,0.506428571428579;19.7835714285714,10.6403571428571;19.7835714285714,24.7921428571429;19.8728571428572,13.9885714285714;19.9175000000000,15.0600000000000;20.0067857142857,16.1314285714286;20.1407142857143,22.5600000000000;20.1407142857143,31.7564285714286;20.3192857142857,10.4171428571429;20.4978571428572,12.6492857142857;20.5425000000000,17.2921428571429;20.6764285714286,18.9885714285714;20.7657142857143,12.0242857142857;20.8550000000000,19.0778571428571;21.0335714285714,3.36357142857143;21.1228571428572,9.97071428571429;21.1228571428572,15.6850000000000;21.3014285714286,-11.9935714285714;21.3014285714286,16.7564285714286;21.4800000000000,-29.4935714285714;21.6585714285714,-32.5292857142857;21.9264285714286,-13.1542857142857;22.0157142857143,22.5153571428572;22.1050000000000,-18.4221428571429;22.1050000000000,18.0957142857143;22.9085714285714,14.6135714285714;23.2657142857143,19.0778571428571;23.8014285714286,2.11357142857143;23.8907142857143,14.5242857142857;23.8907142857143,24.8814285714286;23.9800000000000,3.45285714285715;24.0692857142857,7.47071428571429;24.0692857142857,13.4528571428571;24.1585714285714,11.2207142857143;24.3371428571429,10.9528571428571;24.6942857142857,-17.5292857142857;24.6942857142857,6.93500000000000;25.0514285714286,8.81000000000000;25.2300000000000,-5.29714285714285;25.3192857142857,5.46178571428572;25.4978571428572,12.1135714285714;25.5871428571429,12.6492857142857;25.6764285714286,16.4885714285714;25.8550000000000,22.1135714285714;25.8550000000000,28.6314285714286;25.9442857142857,5.23857142857143;26.0335714285714,0.685000000000002;26.0335714285714,19.9707142857143;26.1228571428572,-21.7703571428571;26.1228571428572,31.0421428571429;26.2567857142857,4.97071428571429;26.3014285714286,-12.7078571428571;26.3907142857143,-20.8328571428571;26.3907142857143,24.7921428571429;26.5692857142857,-20.7435714285714;26.6585714285714,-31.4578571428571;26.6585714285714,5.86357142857143;26.7478571428572,11.7564285714286;27.1050000000000,13.2742857142857;27.1050000000000,19.1671428571429;27.1942857142857,3.09571428571429;27.2389285714286,-28.2435714285714;27.5514285714286,6.31000000000000;27.8192857142857,-23.8685714285714;27.8192857142857,13.0064285714286;27.9978571428572,-5.74357142857142;28.5335714285714,-24.0025000000000;28.5335714285714,8.81000000000000;28.5335714285714,14.4350000000000;28.8014285714286,16.3100000000000;28.8907142857143,8.63142857142858;29.2478571428572,-16.9042857142857;29.2478571428572,24.7921428571429;29.4264285714286,11.9350000000000;29.4264285714286,24.5242857142857;29.4264285714286,32.3814285714286;29.6050000000000,19.5242857142857;29.7835714285714,26.8457142857143;29.9621428571429,0.0153571428571482;29.9621428571429,13.4528571428571;30.0514285714286,16.8457142857143;30.1407142857143,-21.4578571428571;30.3192857142857,20.8189285714286;30.3192857142857,22.7385714285714;30.3192857142857,27.7385714285714;30.6764285714286,1.04214285714286;30.7657142857143,11.5778571428571;30.9442857142857,-27.7971428571429;30.9442857142857,32.3814285714286;31.0335714285714,30.0600000000000;31.1228571428572,4.61357142857143;32.1050000000000,6.57785714285715;32.2835714285714,24.7921428571429;32.3728571428572,15.5957142857143;32.6407142857143,10.0600000000000;33.0871428571429,-1.27928571428571;33.0871428571429,5.41714285714286;33.2657142857143,10.0600000000000;33.8907142857143,-10.4757142857143;33.8907142857143,25.9528571428572;34.1585714285714,4.25642857142858;34.2478571428572,-3.24357142857142;34.6050000000000,15.4171428571429;34.6050000000000,19.2564285714286;34.6942857142857,-23.6900000000000;34.6942857142857,-22.9757142857143;34.7835714285714,-12.4400000000000;34.8728571428572,-3.86857142857142;35.4085714285714,-18.5114285714286;35.4085714285714,2.64928571428572;35.4085714285714,3.89928571428572;35.4978571428572,-24.0471428571429;35.9442857142857,14.4350000000000;36.0782142857143,-10.0292857142857;36.4800000000000,27.2921428571429;36.5692857142857,-24.9400000000000;36.6585714285714,19.0778571428571;36.7478571428572,22.1135714285714;36.8371428571429,1.48857142857143;36.9264285714286,-20.7435714285714;37.4621428571429,-27.7078571428571;37.8192857142857,4.34571428571429;37.9978571428572,34.2117857142857;38.4442857142857,20.7742857142857;38.8907142857143,-15.9221428571429;38.9800000000000,13.2742857142857;39.1139285714286,32.0242857142857;39.4264285714286,-21.5471428571429;39.5157142857143,15.4171428571429;39.7835714285714,29.6135714285714;41.0782142857143,20.8635714285714;42.2835714285714,7.38142857142858;42.5514285714286,15.7742857142857;42.9978571428572,11.8457142857143;43.5335714285714,22.9171428571429;43.8907142857143,-25.4757142857143;44.2478571428572,1.75642857142858;45.7657142857143,-22.1721428571429;46.3014285714286,-32.6185714285714];
if arena
        %         sx = 2*(side_lx-2)*(rand()-0.5);
        %         sy = 2*(side_ly-2)*(rand()-0.5);
        
        spot_idx = randi(length(spots));
        sx = spots(spot_idx,1);
        sy = spots(spot_idx,2);
    else
        sx = 2*(side_l-2)*(rand()-0.5);
        sy = 2*(side_l-2)*(rand()-0.5);
    end
    
else
    
    sx = 0;
    sy = 0;
end


% End on capture
success = 0;

% Set to one to linearly decrease body velocity as a function of
% concentration
velocity = 1;

%Set to one to vary OU sigma with conc
phi_var = 1;

% Capture time t_final
capture = 1;




%% Starting postion and heading

% X,Y initial conditions

if ~arena
    startx = capture_dist + 30 + rand()*(side_l-capture_dist-30);
    starty = -side_l + 2*rand()*side_l;
    theta = 2*rand()*pi; % random starting dirsection
else
    l = 5;
    startx = capture_dist + 30 + rand()*(side_lx-capture_dist-30); % Random starting position
    
    
    
    %Heading initial conditions
    theta = 2*rand()*pi; % random starting dirsection
    starty = -side_ly + 2*rand()*side_ly;
end

d = 0;
if capture
    %Reject starting locations w/in cap radius
    d = sqrt((sx-startx)^2 + (sy-starty)^2);
    while d < capture_dist+30
        if arena
            startx = -side_lx + 2*rand()*side_lx; % Random starting position
        else
            startx = -side_l + 2*rand()*side_l; % Random starting position
        end
        % starty = -side_l + 2*rand()*side_l;
        starty = 0;
        d = sqrt(startx^2 + starty^2);
    end
    %Uncomment for theta pointing toward source
    %     theta = atan2(-starty,-startx );
    
    %thstart = angdiff(theta, atan2(-starty,-startx ));
    thstart = wrapToPi(atan2(-starty,-startx)-theta);
end


%% Mouse intrinsic parameters
% Length in cm, time in sec, angle in radians

vel = 25; % cm/s
vel_min = 0;
l = 5; % radius of perturbation (neck length)
turn = 1; % factor of phi to turn by NOT SCALED
internostril_dist = 0.18; % cm
lhat = sqrt(l^2 + (internostril_dist/2)^2);
bin_ang = asin((internostril_dist/2)/lhat);
phi_max = 0.3; % Standard deviation of nose deflection
phi_min = 0.2;
phi_effective = phi_min;
tau = .1; % Time constant for nose deflection
k_bin_diff = 200; % Strength of binaral bias in nose OU random walk
k_bin_mag = 2;

k = 1/2;

kv = 1/2;
kc = 1/2;
nv = 4;
nc = 1;


step = 1/10; % corresponds to 10 Hz sniffing
realtime = 0; % 1 if simulation runs at 1 sec/sec, 0 if runs quickly
maxt = 180;% Max sim time

dirs = 0;

noisemod = 1; % Scales noise in heading theta
noiselevel =.5; %Scales noise in concentration
filt = 4;
k_int = 0.02;

%% Varargin value assignment

p = inputParser;
addOptional(p,'X',startx);
addOptional(p,'Y',starty );
addOptional(p,'SX',sx );
addOptional(p,'SY',sy );
addOptional(p,'Ksm',k_bin_mag );
addOptional(p,'Ksd',k_bin_diff );
addOptional(p,'Theta',theta );
addOptional(p,'Time',maxt );
addOptional(p,'Phi_max',phi_max );
addOptional(p,'Phi_min',phi_min );
addOptional(p,'Vmax',vel );
addOptional(p,'L',l );
addOptional(p,'dnares',internostril_dist );
addOptional(p,'Velvar',velocity );
addOptional(p,'Phivar',phi_var );
addOptional(p,'k',k );
addOptional(p,'noiselevel',noiselevel );
addOptional(p,'tau',tau );
addOptional(p,'filt',filt );
addOptional(p,'kint',k_int );
addOptional(p,'kv',kv );
addOptional(p,'kc',kc );
addOptional(p,'nv',nv );
addOptional(p,'nc',nc );
parse(p,varargin{:});

startx  = p.Results.X;
starty  = p.Results.Y;
sx      = p.Results.SX;
sy      = p.Results.SY;
k_bin_mag= p.Results.Ksm;
k_bin_diff= p.Results.Ksd;
theta   = p.Results.Theta;
maxt   = p.Results.Time;
phi_max = p.Results.Phi_max;
phi_min = p.Results.Phi_min;
vel     = p.Results.Vmax;
l       = p.Results.L;
internostril_dist = p.Results.dnares;
velocity = p.Results.Velvar;
phi_var = p.Results.Phivar;
k = p.Results.k;
noiselevel = p.Results.noiselevel;
tau = p.Results.tau;
filt = p.Results.filt;
k_int = p.Results.kint;
kv = p.Results.kv;
kc = p.Results.kc;
nv = p.Results.nv;
nc = p.Results.nc;


wl = 1;
wr = 1;
wsum = wl+wr;

lhat = sqrt(l^2 + (internostril_dist/2)^2);
bin_ang = asin((internostril_dist/2)/lhat);


% Noise in heading
beta = noisemod*pi/30;



%% Odor Environment

stdev = 20;
% odorFun = @(x,y,varargin)   exp( -sqrt( (x-sx)^2 + (y-sy)^2 ) / (2*stdev) ); % exponential


xgrid = -side_lx:0.1:side_lx;
ygrid = -side_ly:0.1:side_ly;

% global conc_grid
conc_grid = corr_noise6(xgrid,ygrid, 'noise',noiselevel,'filt',filt,'kint',k_int,'sx',sx,'sy',sy);


odorFun = @(x,y,varargin) odorFun_grid(x,y,conc_grid);

%% Initialize Plot


%Initialize body and nose positions
mx = startx;
my = starty;
nx = startx+l*cos(theta);
ny = starty+l*sin(theta);


%% Algorithm

% Initialization: Get conc at nose position at the initial position
conc_old = -Inf; % updated in loop before used
conc_new = odorFun(nx, ny,0);




%Scale velocity to step size
v = vel*step;

% Saves variables
pos_vals = nan(maxt/step,2); % x,y position
nose_vals =  nan(maxt/step,2);
th_vals = nan(maxt/step,1);
dirs_vals = nan(maxt/step,1);
th_rel = nan(maxt/step,1);
dists = nan(maxt/step,1);
conc_vals = nan(maxt/step,1);
vel_vals = nan(maxt/step,1);

%Always cast
cast = 1;
del_c = 0;
success_idx = NaN;
final_countdown = -1;

for t = 1:maxt/step
    
    pos_vals(t,:) = [mx my]; %Save coordinates
    nose_vals (t,:)= [nx ny];
    th_vals(t) = theta;
    
    
    dists(t) = sqrt( (sx-nx)^2 + (sy-ny)^2);
    
    
    if capture
        
        if pdist([nx ny ; sx sy]) < capture_dist & success == 0 % Did mouse reach source?
            t_final = t*step;
            success = 1;
            success_idx = t;
            break
        end
        if t == maxt/step
            t_final = NaN;              % If time expired, return NaN
        end
        
    end
    
    if t == maxt/step
        t_final = NaN;              % If time expired, return NaN
    end
    
    
    
    
    % Is nose out of bounds?
    if bounded
        if ~arena
            if abs(nx)>side_l || abs(ny)>side_l  %  outside of box?
                %If so, reverse course
                theta = theta + pi; %reverse course
            end
            
        else
            
            % Check if out of bounds for real arena geometry
            if abs(nx)>side_lx || abs(ny) > side_ly  %  outside of box?
                %         If so, reverse course
                theta = theta + pi; %reverse course
            end
            
        end
    end
    
    
    mx = mx + v*cos(theta);
    my = my + v*sin(theta);
    
    
    %Chose a cast dirsection
%     dirs = dirs + -step*dirs/tau + phi_effective*randn()*sqrt(step/tau) + k_bin*step*del_c; % Biased OU model with binaral component
      dirs = dirs + -step*dirs/tau + phi_effective*randn()*sqrt(step/tau) + k_bin_mag*tanh(k_bin_diff*del_c)*step; % Biased OU model with binaral component

    
    
    dirs_vals(t) = dirs;
    
    % Update nose pos
    nx = mx + l*cos(theta+dirs);
    ny = my + l*sin(theta+dirs);
    
    nxl = mx + lhat*cos(theta+dirs+bin_ang);
    nyl = my + lhat*sin(theta+dirs+bin_ang);
    
    nxr = mx + lhat*cos(theta+dirs-bin_ang);
    nyr = my + lhat*sin(theta+dirs-bin_ang);
    
    
    
    if cast & mod(t*step,0.1)==0
        
        
        
        conc_vals(t) = conc_new;
        % Sample Concentration
        if (wl*(odorFun(nxl,nyl,conc_new)+max(0, odorFun(nxl,nyl,conc_new)  )   )      +    wr*odorFun(nxr,nyr,conc_new))     /wsum > conc_thres
            
            conc_old = conc_new;
            
            cl = odorFun(nxl,nyl,conc_old);
            cr = odorFun(nxr,nyr,conc_old); 
            
            conc_new = (wl*cl        +         wr*cr )/wsum;
            
            del_c = (wl*cl - wr*cr)/wsum;
            
            dirs_vals_mc_p(t) = conc_new;
            
            
            
            if conc_new>conc_old
                if randwalk
                    theta = theta +dirs*turn+ beta*randn();
                else
                    theta = theta +dirs*turn;
                end
                
            else
                if randwalk
                    %                     theta = theta + beta*randn();
                    theta = theta -dirs*turn+ beta*randn();
                else
                    theta = theta -dirs*turn;
                end
                
            end
            
            
            
        else % If subthreshold
            
            conc_old = conc_new;
            conc_new = (wl*odorFun(nxl,nyl,conc_old)+wr*odorFun(nxr,nyr,conc_old))/wsum;
            del_c = (wl*odorFun(nxl,nyl,conc_old) - wr*odorFun(nxr,nyr,conc_old));
            if randwalk
%                 theta = theta + beta*randn();
                if rand()>0.5
                    theta = theta+dirs;
                else
                    theta = theta-dirs;
                end
            end
        end
        
    end
    
    
    if double(get(gcf,'CurrentCharacter'))==27
        t_final = t*step;
        break
    end
    
    
    % Variable velocities
    if velocity
        hill = 4;
        v = (vel - (vel-vel_min)*conc_new^nv/(kv+conc_new^nv))*step;
    end
    
    
    % Variable phi values
    if phi_var
        hill = 1;
        phi_effective = (phi_min + (phi_max-phi_min)*conc_new^nc/(kc+conc_new^nc));
    end
    
    vel_vals(t) = v/step;
    
    
    
end

% Truncate vars
pos_vals = pos_vals(1:t,:); % x,y position
nose_vals = nose_vals(1:t,:); % nose x,y
th_vals = th_vals(1:t,:); % abs heading angles
th_rel = th_rel(1:t,:); % abs heading angles
dists = dists(1:t,:);
nose_vals = nose_vals(1:t,:);
pos_vals = pos_vals(1:t,:);
dirs_vals = wrapToPi( dirs_vals(1:t,:) );
th_vals = wrapToPi(   th_vals(1:t,:)   );
th_rel = wrapToPi(   th_rel(1:t,:)   );
conc_vals = conc_vals(1:t,:);

if t == maxt/step
    t_final = NaN;              % If time expired, return NaN
else
    t_final = t*step;
end

if success
    pathlength = sum(hypot( diff(nose_vals(:,1)) , diff(nose_vals(:,2)) ) );
else
    pathlength = NaN;
end


t= 0:step:(t-1)/step;

end